<!-- This was generated by opencode using Big Pickle -->

# AGENTS.md

This is a Neovim configuration repository using LazyVim. It contains personal
Neovim settings, keymaps, plugins, and LSP configurations.

## Project Overview

- **Language**: Lua (Neovim config)
- **Framework**: LazyVim
- **Plugin Manager**: lazy.nvim
- **Main Files**:
  - `init.lua` - Entry point
  - `lua/config/` - Core configuration (options, keymaps, autocmds, lazy setup)
  - `lua/plugins/` - Plugin specifications
  - `lua/utils/` - Utility functions

## Build / Lint / Test Commands

This is a Neovim configuration repository, not a software project with a build
process. However, the following tools can be used to validate and format the
code:

### Formatting

**stylua** - Lua code formatter

```bash
stylua lua/
stylua --check lua/  # Check without fixing
```

Configuration in `stylua.toml`:

- Indent: 2 spaces
- Column width: 120
- Quote style: Force single quotes

### Linting / Type Checking

**emmylua_ls** (or lua_ls)
- Integrated via Neovim LSP
- Provides diagnostics and type checking
- Configured in `lua/plugins/lsp.lua`

**Neovim built-in diagnostics**

```bash
nvim --headless -c "lua vim.diagnostic.enable()" -c "qa" .
```

### EditorConfig

The project uses EditorConfig (`.editorconfig`):

- UTF-8 charset
- LF line endings
- Trim trailing whitespace
- 2-space indentation

## Code Style Guidelines

Follow the same structure as the formatting guide but
do not leave any unnecessary trailing commas.

### General Structure

```lua
--- @diagnostic disable: missing-fields, param-type-mismatch

return --[[@type LazyPluginSpec]]{
  {
    'owner/repo',
    opts = {}
  }
}
```

### Imports

- Use `require('module')` for external plugins
- Use `vim.*` for Neovim built-ins
- Group imports at the top of files or in lazy loading blocks
- Example:

  ```lua
  local api = require('nvim-tree.api')
  local vim_keymap = vim.keymap
  ```

### Formatting

- **Indent**: 2 spaces (no tabs)
- **Column limit**: 120 characters
- **Quotes**: Single quotes (`'`)
- **Line endings**: LF (Unix)
- **Trailing whitespace**: Trimmed
- **Final newline**: Required

### Naming Conventions

- **Variables**: `snake_case` (e.g., `local function my_function()`)
- **Tables/Modules**: `snake_case`
- **Keymap descriptions**: `Title Case` with prefix (e.g., `'nvim-tree: Explorer'`)
- **Plugin keys**: Descriptive, use `<leader>` for user keymaps

### Type Annotations

Use LuaLS annotation syntax for type hints:

```lua
---@param bufnr integer
---@return string
local function get_buf_name(bufnr)
  return vim.api.nvim_buf_get_name(bufnr)
end
```

Common annotations:
- `---@param` - Function parameters
- `---@return` - Return type
- `---@type` - Variable type
- `---@class` - Class definition
- `---@module` - Module reference
- `---@diagnostic disable` - Disable specific diagnostics

### Error Handling

- Use `pcall` for unsafe requires:
  ```lua
  local mod, ok = pcall(require, 'module')
  if not ok then return end
  ```
- Use `vim.v.shell_error` for shell command errors
- Use diagnostic disable comments for known false positives:
  ```lua
  --- @diagnostic disable-next-line: param-type-mismatch
  ```

### Keymaps

Define a helper function for consistent keymap options:

```lua
---@param desc string
---@param silent boolean?
---@return vim.keymap.set.Opts
local function opts(desc, silent)
  silent = silent or false
  return { desc = desc, silent = silent, noremap = true }
end

vim_keymap.set('n', '<leader>key', function() end, opts('Description'))
```

Keymap modes: `'n'`, `'x'`, `'i'`, `'t'`, or arrays like `{ 'n', 'x' }`

### Plugin Configuration

Plugin specs return tables with keys:
- `opts` - Configuration table or function
- `keys` - Keymap definitions
- `cmd` - Commands that trigger loading
- `event` - Autocmd events
- `lazy` - Lazy loading setting
- `init` - Initialization function
- `config` - Setup function

```lua
{
  'owner/plugin',
  event = 'VeryLazy',
  keys = {
    { '<leader>k', function() end, desc = 'Do something' }
  },
  opts = {
    option = value
  }
}
```

### LazyVim Integration

- Use `LazyVim.root()` for root directory detection
- Use `Snacks.picker.*` for picker configurations
- Import extras from `lazyvim.plugins.extras.*`
- Follow LazyVim conventions for consistency

### Testing

This repository doesn't have automated tests. Manual testing is done by:

1. Open Neovim with this config: `NVIM_APPNAME=nvim nvim`
2. Check for errors on startup
3. Test keybindings and plugin functionality

### Common Patterns

**Disabling diagnostics for specific lines:**
```lua
--- @diagnostic disable-next-line: unused-local
```

**File detection for LSP:**
```lua
root_dir = function(_, on_dir)
  on_dir((util.root_pattern('.git'))(fname))
end
```

**Checking if file exists:**
```lua
local uv = vim.uv
local exists = uv.fs_stat(path)
```

**Handling environment variables:**
```lua
local path = os.getenv('HOME') .. '/config'
```

## Useful Commands

```bash
# Sync plugins
nvim --headless -c "Lazy! sync" -c "qa"

# Check plugin status
nvim --headless -c "Lazy" -c "qa"

# Update lock file
nvim --headless -c "Lazy update" -c "qa"
```

## File Organization

```
lua/
├── config/
│   ├── options.lua    -- vim.opt settings
│   ├── keymaps.lua    -- keybindings
│   ├── autocmds.lua   -- autocommands
│   └── lazy.lua      -- plugin manager setup
├── plugins/
│   ├── init.lua      -- main plugins
│   ├── lsp.lua       -- LSP configuration
│   ├── extra-config.lua
│   ├── no-config.lua
│   └── rocks.lua     -- LuaRocks plugins
└── utils/
    └── init.lua      -- utility functions
```
